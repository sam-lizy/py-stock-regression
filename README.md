

## 首先下载这些数据 https://pan.huang1111.cn/s/v28gCE 

## 然后放在src同目录新建assets文件夹 把数据放在assets文件夹里面

### 1.统计“news.xlsx”文件中每条新闻标题的正面词汇、负面词汇数量



### 2.根据题1中统计的正、负向词汇数量，计算每支股票每周的情绪指标SENi,t，计算公式如下：

​		SENi,t = (positivei,t – negativei,t)/(1+ positivei,t + negativei,t)

​		其中，i表示第i支股票，t表示第t周，positivei,t和negativei,t分别股票i为第t周的正、负面词汇数量。

 

### 3.将题2中每支股票的周情绪指标作为一个重要因子纳入三因子模型中，得到四因子模型如下：

​		Ri,t – shibort = a + b1MKTt +b2SMBt + b3HMLt + b4SENi,t + e

​		其中，Ri,t为股票i第周t的对数收益率，采用周平均对数收益率衡量，MKTt、SMBt和HMLt均采用周平均值衡量。

​		利用2020年的数据，估计每支股票的a、	b1、	b2、b3和b4值。

 

### 4.根据题3中a、b1、b2、b3和b4的估计值，筛选出满足如下要求的股票i，并以T=13为窗口宽度，预测股票i每周的收益率，最后将每周的预测值与实际值绘制在一张图上：

##### 	（1）b4在5%水平上显著；

##### 	（2）b4大于0；

##### 	（3）调整后的R2值最大





# 说明

### 1.工作目录选择在该文件夹，运行main稍等即可跑出结果

 

### 2.所需数据存放在assets文件夹，数据路径放在contants文件夹。对四个题目的详细代码，则在src目录的index里按注释分列。其中，deal_factors,deal_returns等py文件，是分装的定义获取周平均收益率，计算情绪值，周平均shibor等必要过程的函数。Paint是画图代码。



### 3.四因子模型，采用mod = sm.OLS(y,x).fit()函数计算回归。而预测股价，采用T=13的简单移动平均法预测，因此前几周预测值为空值。 

 

### 4.最终四因子计算公式为：

![](png (1).png)

其中，RIT代表i周t股票的周平均收益率，shibort值为上海银行间同业拆借利率一年的数据并按周平均计算的结果。Fama-French三因子回归是量化中最经典的模型之一，最早提出是在论文《Common risk factors in the returns on stocks and bonds》中，FAMA三因子回归模型可表示如下

其中，rt为投资组合的收益率，rf为无风险收益率，SMB为规模因子，HML为账面市值比因子，MKT为市场因子。MKT定义为RM-RF，其中RM为全市场股票市值加权收益率,RF是无风险利率。

Fama-French三因子回归通过计算上述的三个因子，对股票的收益来源进行了分解。本组代码基于这篇论文的算法，在A股股吧中爬取28000余组股票新闻标题及评论，利用词库分析其情绪指标，将情绪指标作为第四个因子，从而建立四因子模型，运用回归分析，计算各因子系数及alpha。最终，筛选出情绪因子系数大于0，并在95%的置信区间上显著，同时R2最大的那支股票作为结果，以T=13为时间窗口宽度预测其周收益率，并将其周平均收益率与原始数据共同绘制在一张图上。

### 5.代码最终筛选出b4大于0，过滤p值及最大R2后选出的股票代码为600814，R2约为0.44。股票筛选结果及图片绘制如下所示。

![](png(2).png)

![](png (3).png)

![](png (4).png)
